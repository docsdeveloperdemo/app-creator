<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A-Frame VR Experience</title>
    <meta name="description" content="Interactive VR Experience built with A-Frame">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/supermedium/superframe@master/components/environment/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/supermedium/superframe@master/components/event-set/dist/aframe-event-set-component.min.js"></script>
    <script src="/js/components.js"></script>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="spinner"></div>
        <h2>Loading VR Experience...</h2>
    </div>

    <!-- Info Panel -->
    <div id="info-panel">
        <h3>VR Controls</h3>
        <p><strong>Desktop:</strong> Click and drag to look around</p>
        <p><strong>Mobile:</strong> Move your device or touch and drag</p>
        <p><strong>VR Headset:</strong> Look around naturally</p>
        <p>Click on objects to interact!</p>
        <button onclick="toggleInfo()">Close</button>
    </div>

    <a-scene
        vr-mode-ui="enabled: true"
        loading-screen="dotsColor: red; backgroundColor: black"
        stats>
        
        <!-- Assets -->
        <a-assets>
            <!-- Textures -->
            <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="anonymous">
            <img id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg" crossorigin="anonymous">
            
            <!-- Audio -->
            <audio id="click-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/click.ogg" crossorigin="anonymous"></audio>
            
            <!-- Mixins for reusable components -->
            <a-mixin id="cube" geometry="primitive: box; width: 1; height: 1; depth: 1"></a-mixin>
            <a-mixin id="sphere" geometry="primitive: sphere; radius: 0.5"></a-mixin>
            <a-mixin id="hover-animation" 
                animation__mouseenter="property: scale; to: 1.2 1.2 1.2; startEvents: mouseenter; dur: 200"
                animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
            </a-mixin>
        </a-assets>

        <!-- Environment -->
        <a-entity environment="preset: forest; groundColor: #445; grid: cross"></a-entity>

        <!-- Interactive Objects -->
        
        <!-- Rotating Cube -->
        <a-entity 
            mixin="cube hover-animation"
            material="color: #FF6B6B; metalness: 0.7"
            position="-3 1.5 -5"
            rotation="45 45 0"
            animation="property: rotation; to: 405 405 0; loop: true; dur: 10000"
            sound="src: #click-sound; on: click"
            clickable
            class="interactive">
            <a-text value="Rotating Cube" position="0 1.5 0" align="center" color="#FFF"></a-text>
        </a-entity>

        <!-- Color Changing Sphere -->
        <a-entity
            mixin="sphere hover-animation"
            material="color: #4ECDC4"
            position="0 2 -5"
            color-changer
            sound="src: #click-sound; on: click"
            clickable
            class="interactive">
            <a-text value="Click to Change Color" position="0 1.2 0" align="center" color="#FFF"></a-text>
        </a-entity>

        <!-- Bouncing Cylinder -->
        <a-cylinder
            color="#FFD93D"
            height="2"
            radius="0.5"
            position="3 1 -5"
            animation="property: position; to: 3 3 -5; dir: alternate; loop: true; dur: 1000; easing: easeInOutQuad"
            mixin="hover-animation"
            sound="src: #click-sound; on: click"
            clickable
            class="interactive">
            <a-text value="Bouncing Cylinder" position="0 1.5 0" align="center" color="#333"></a-text>
        </a-cylinder>

        <!-- Portal Ring -->
        <a-torus
            color="#9B59B6"
            radius="2"
            radius-tubular="0.1"
            position="0 3 -10"
            rotation="0 0 0"
            animation="property: rotation; to: 360 360 0; loop: true; dur: 5000"
            portal-effect
            class="interactive">
        </a-torus>

        <!-- Particle System -->
        <a-entity
            position="0 2.5 -10"
            particle-system="
                preset: snow;
                particleCount: 2000;
                color: #EF0FFF,#44CC00;
                size: 0.1;
                velocityValue: 0 2 0;
                velocitySpread: 1 0 1;
                accelerationValue: 0 -1 0;
                opacity: 0.5;
                blending: 1">
        </a-entity>

        <!-- Interactive Floor Tiles -->
        <a-entity id="floor-tiles" position="0 0 -8">
            <a-box color="#2ECC71" position="-2 0.1 0" width="1.8" height="0.2" depth="1.8" 
                   tile-interaction class="tile"></a-box>
            <a-box color="#3498DB" position="0 0.1 0" width="1.8" height="0.2" depth="1.8" 
                   tile-interaction class="tile"></a-box>
            <a-box color="#E74C3C" position="2 0.1 0" width="1.8" height="0.2" depth="1.8" 
                   tile-interaction class="tile"></a-box>
        </a-entity>

        <!-- Orbiting Satellites -->
        <a-entity position="0 4 -8" id="orbit-center">
            <a-sphere color="#F39C12" radius="0.5" position="0 0 0">
                <a-sphere color="#E74C3C" radius="0.2" position="2 0 0"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 3000"></a-sphere>
                <a-sphere color="#3498DB" radius="0.15" position="0 0 1.5"
                    animation="property: rotation; to: 0 -360 0; loop: true; dur: 2000"></a-sphere>
            </a-sphere>
            <a-animation attribute="rotation" to="0 360 0" dur="10000" repeat="indefinite"></a-animation>
        </a-entity>

        <!-- Text Messages -->
        <a-text
            value="Welcome to A-Frame VR Experience!"
            position="0 5 -6"
            align="center"
            color="#FFF"
            geometry="primitive: plane; width: 8; height: auto"
            material="color: #333; opacity: 0.8"
            animation="property: position; to: 0 5.5 -6; dir: alternate; loop: true; dur: 2000">
        </a-text>

        <!-- Interactive Light Switch -->
        <a-box
            id="light-switch"
            color="#FFFF00"
            position="-5 2 -3"
            width="0.5"
            height="1"
            depth="0.2"
            light-toggle
            class="interactive"
            sound="src: #click-sound; on: click">
            <a-text value="Light Switch" position="0 0.7 0" align="center" color="#333" scale="0.5 0.5 0.5"></a-text>
        </a-box>

        <!-- Dynamic Light -->
        <a-light
            id="dynamic-light"
            type="point"
            color="#FFF"
            intensity="0"
            position="0 5 0"
            animation__intensity="property: intensity; to: 2; startEvents: lighton; dur: 500"
            animation__intensityoff="property: intensity; to: 0; startEvents: lightoff; dur: 500">
        </a-light>

        <!-- Camera with Cursor -->
        <a-entity camera look-controls wasd-controls position="0 1.6 0">
            <a-cursor
                animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                animation__fusing="property: scale; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
                raycaster="objects: .interactive, .tile"
                geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                material="color: white; shader: flat">
            </a-cursor>
            
            <!-- HUD Elements -->
            <a-text
                value="Press 'i' for info"
                position="0.3 -0.3 -1"
                scale="0.3 0.3 0.3"
                color="#FFF"
                font="kelsonsans">
            </a-text>
        </a-entity>

        <!-- Ambient and Directional Lighting -->
        <a-light type="ambient" color="#404040"></a-light>
        <a-light type="directional" color="#FFF" intensity="0.5" position="-0.5 1 1"></a-light>

        <!-- Sky with gradient -->
        <a-sky color="#ECECEC" material="shader: gradient; topColor: #1e3c72; bottomColor: #2a5298"></a-sky>
    </a-scene>

    <script src="/js/main.js"></script>
</body>
</html>